<p align="right">
   <strong>ä¸­æ–‡</strong> | <a href="./README.en.md">English</a>
</p>
<div align="center">

![new-api](/web/public/logo.png)

# New API


ğŸ¥æ–°ä¸€ä»£å¤§æ¨¡å‹ç½‘å…³ä¸AIèµ„äº§ç®¡ç†ç³»ç»Ÿ

<a href="https://trendshift.io/repositories/8227" target="_blank"><img src="https://trendshift.io/api/badge/repositories/8227" alt="Calcium-Ion%2Fnew-api | Trendshift" style="width: 250px; height: 55px;" width="250" height="55"/></a>

<p align="center">
  <a href="https://raw.githubusercontent.com/Calcium-Ion/new-api/main/LICENSE">
    <img src="https://img.shields.io/github/license/Calcium-Ion/new-api?color=brightgreen" alt="license">
  </a>
  <a href="https://github.com/Calcium-Ion/new-api/releases/latest">
    <img src="https://img.shields.io/github/v/release/Calcium-Ion/new-api?color=brightgreen&include_prereleases" alt="release">
  </a>
  <a href="https://github.com/users/Calcium-Ion/packages/container/package/new-api">
    <img src="https://img.shields.io/badge/docker-ghcr.io-blue" alt="docker">
  </a>
  <a href="https://hub.docker.com/r/CalciumIon/new-api">
    <img src="https://img.shields.io/badge/docker-dockerHub-blue" alt="docker">
  </a>
  <a href="https://goreportcard.com/report/github.com/Calcium-Ion/new-api">
    <img src="https://goreportcard.com/badge/github.com/Calcium-Ion/new-api" alt="GoReportCard">
  </a>
</p>
</div>

## ğŸ“ é¡¹ç›®è¯´æ˜

> [!NOTE]  
> æœ¬é¡¹ç›®ä¸ºå¼€æºé¡¹ç›®ï¼Œåœ¨[One API](https://github.com/songquanpeng/one-api)çš„åŸºç¡€ä¸Šè¿›è¡ŒäºŒæ¬¡å¼€å‘

> [!IMPORTANT]  
> - ä½¿ç”¨è€…å¿…é¡»åœ¨éµå¾ª OpenAI çš„[ä½¿ç”¨æ¡æ¬¾](https://openai.com/policies/terms-of-use)ä»¥åŠ**æ³•å¾‹æ³•è§„**çš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œä¸å¾—ç”¨äºéæ³•ç”¨é€”ã€‚
> - æœ¬é¡¹ç›®ä»…ä¾›ä¸ªäººå­¦ä¹ ä½¿ç”¨ï¼Œä¸ä¿è¯ç¨³å®šæ€§ï¼Œä¸”ä¸æä¾›ä»»ä½•æŠ€æœ¯æ”¯æŒã€‚
> - æ ¹æ®[ã€Šç”Ÿæˆå¼äººå·¥æ™ºèƒ½æœåŠ¡ç®¡ç†æš‚è¡ŒåŠæ³•ã€‹](http://www.cac.gov.cn/2023-07/13/c_1690898327029107.htm)çš„è¦æ±‚ï¼Œè¯·å‹¿å¯¹ä¸­å›½åœ°åŒºå…¬ä¼—æä¾›ä¸€åˆ‡æœªç»å¤‡æ¡ˆçš„ç”Ÿæˆå¼äººå·¥æ™ºèƒ½æœåŠ¡ã€‚

## âœ¨ ä¸»è¦ç‰¹æ€§

1. ğŸ¨ å…¨æ–°çš„UIç•Œé¢ï¼ˆéƒ¨åˆ†ç•Œé¢è¿˜å¾…æ›´æ–°ï¼‰
2. ğŸŒ å¤šè¯­è¨€æ”¯æŒï¼ˆå¾…å®Œå–„ï¼‰
3. ğŸ¨ æ·»åŠ [Midjourney-Proxy(Plus)](https://github.com/novicezk/midjourney-proxy)æ¥å£æ”¯æŒï¼Œ[å¯¹æ¥æ–‡æ¡£](Midjourney.md)
4. ğŸ’° æ”¯æŒåœ¨çº¿å……å€¼åŠŸèƒ½ï¼Œå¯åœ¨ç³»ç»Ÿè®¾ç½®ä¸­è®¾ç½®ï¼š
    - [x] æ˜“æ”¯ä»˜
5. ğŸ” æ”¯æŒç”¨keyæŸ¥è¯¢ä½¿ç”¨é¢åº¦ï¼š
    - é…åˆé¡¹ç›®[neko-api-key-tool](https://github.com/Calcium-Ion/neko-api-key-tool)å¯å®ç°ç”¨keyæŸ¥è¯¢ä½¿ç”¨
6. ğŸ“‘ åˆ†é¡µæ”¯æŒé€‰æ‹©æ¯é¡µæ˜¾ç¤ºæ•°é‡
7. ğŸ”„ å…¼å®¹åŸç‰ˆOne APIçš„æ•°æ®åº“ï¼Œå¯ç›´æ¥ä½¿ç”¨åŸç‰ˆæ•°æ®åº“ï¼ˆone-api.dbï¼‰
8. ğŸ’µ æ”¯æŒæ¨¡å‹æŒ‰æ¬¡æ•°æ”¶è´¹ï¼Œå¯åœ¨ ç³»ç»Ÿè®¾ç½®-è¿è¥è®¾ç½® ä¸­è®¾ç½®
9. âš–ï¸ æ”¯æŒæ¸ é“**åŠ æƒéšæœº**
10. ğŸ“ˆ æ•°æ®çœ‹æ¿ï¼ˆæ§åˆ¶å°ï¼‰
11. ğŸ”’ å¯è®¾ç½®ä»¤ç‰Œèƒ½è°ƒç”¨çš„æ¨¡å‹
12. ğŸ¤– æ”¯æŒTelegramæˆæƒç™»å½•ï¼š
    1. ç³»ç»Ÿè®¾ç½®-é…ç½®ç™»å½•æ³¨å†Œ-å…è®¸é€šè¿‡Telegramç™»å½•
    2. å¯¹[@Botfather](https://t.me/botfather)è¾“å…¥æŒ‡ä»¤/setdomain
    3. é€‰æ‹©ä½ çš„botï¼Œç„¶åè¾“å…¥http(s)://ä½ çš„ç½‘ç«™åœ°å€/login
    4. Telegram Bot åç§°æ˜¯bot username å»æ‰@åçš„å­—ç¬¦ä¸²
13. ğŸµ æ·»åŠ  [Suno API](https://github.com/Suno-API/Suno-API)æ¥å£æ”¯æŒï¼Œ[å¯¹æ¥æ–‡æ¡£](Suno.md)
14. ğŸ”„ æ”¯æŒRerankæ¨¡å‹ï¼Œç›®å‰å…¼å®¹Cohereå’ŒJinaï¼Œå¯æ¥å…¥Difyï¼Œ[å¯¹æ¥æ–‡æ¡£](Rerank.md)
15. âš¡ **[OpenAI Realtime API](https://platform.openai.com/docs/guides/realtime/integration)** - æ”¯æŒOpenAIçš„Realtime APIï¼Œæ”¯æŒAzureæ¸ é“
16. æ”¯æŒä½¿ç”¨è·¯ç”±/chat2link è¿›å…¥èŠå¤©ç•Œé¢
17. ğŸ§  æ”¯æŒé€šè¿‡æ¨¡å‹åç§°åç¼€è®¾ç½® reasoning effortï¼š
    - æ·»åŠ åç¼€ `-high` è®¾ç½®ä¸º high reasoning effort (ä¾‹å¦‚: `o3-mini-high`)
    - æ·»åŠ åç¼€ `-medium` è®¾ç½®ä¸º medium reasoning effort (ä¾‹å¦‚: `o3-mini-medium`)
    - æ·»åŠ åç¼€ `-low` è®¾ç½®ä¸º low reasoning effort (ä¾‹å¦‚: `o3-mini-low`)

## æ¨¡å‹æ”¯æŒ
æ­¤ç‰ˆæœ¬é¢å¤–æ”¯æŒä»¥ä¸‹æ¨¡å‹ï¼š
1. ç¬¬ä¸‰æ–¹æ¨¡å‹ **gps** ï¼ˆgpt-4-gizmo-*ï¼‰
2. [Midjourney-Proxy(Plus)](https://github.com/novicezk/midjourney-proxy)æ¥å£ï¼Œ[å¯¹æ¥æ–‡æ¡£](Midjourney.md)
3. è‡ªå®šä¹‰æ¸ é“ï¼Œæ”¯æŒå¡«å…¥å®Œæ•´è°ƒç”¨åœ°å€
4. [Suno API](https://github.com/Suno-API/Suno-API) æ¥å£ï¼Œ[å¯¹æ¥æ–‡æ¡£](Suno.md)
5. Rerankæ¨¡å‹ï¼Œç›®å‰æ”¯æŒ[Cohere](https://cohere.ai/)å’Œ[Jina](https://jina.ai/)ï¼Œ[å¯¹æ¥æ–‡æ¡£](Rerank.md)
6. Dify

æ‚¨å¯ä»¥åœ¨æ¸ é“ä¸­æ·»åŠ è‡ªå®šä¹‰æ¨¡å‹gpt-4-gizmo-*ï¼Œæ­¤æ¨¡å‹å¹¶éOpenAIå®˜æ–¹æ¨¡å‹ï¼Œè€Œæ˜¯ç¬¬ä¸‰æ–¹æ¨¡å‹ï¼Œä½¿ç”¨å®˜æ–¹keyæ— æ³•è°ƒç”¨ã€‚

## æ¯”åŸç‰ˆOne APIå¤šå‡ºçš„é…ç½®
- `GENERATE_DEFAULT_TOKEN`ï¼šæ˜¯å¦ä¸ºæ–°æ³¨å†Œç”¨æˆ·ç”Ÿæˆåˆå§‹ä»¤ç‰Œï¼Œé»˜è®¤ä¸º `false`ã€‚
- `STREAMING_TIMEOUT`ï¼šè®¾ç½®æµå¼ä¸€æ¬¡å›å¤çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸º 60 ç§’ã€‚
- `DIFY_DEBUG`ï¼šè®¾ç½® Dify æ¸ é“æ˜¯å¦è¾“å‡ºå·¥ä½œæµå’ŒèŠ‚ç‚¹ä¿¡æ¯åˆ°å®¢æˆ·ç«¯ï¼Œé»˜è®¤ä¸º `true`ã€‚
- `FORCE_STREAM_OPTION`ï¼šæ˜¯å¦è¦†ç›–å®¢æˆ·ç«¯stream_optionså‚æ•°ï¼Œè¯·æ±‚ä¸Šæ¸¸è¿”å›æµæ¨¡å¼usageï¼Œé»˜è®¤ä¸º `true`ï¼Œå»ºè®®å¼€å¯ï¼Œä¸å½±å“å®¢æˆ·ç«¯ä¼ å…¥stream_optionså‚æ•°è¿”å›ç»“æœã€‚
- `GET_MEDIA_TOKEN`ï¼šæ˜¯å¦ç»Ÿè®¡å›¾ç‰‡tokenï¼Œé»˜è®¤ä¸º `true`ï¼Œå…³é—­åå°†ä¸å†åœ¨æœ¬åœ°è®¡ç®—å›¾ç‰‡tokenï¼Œå¯èƒ½ä¼šå¯¼è‡´å’Œä¸Šæ¸¸è®¡è´¹ä¸åŒï¼Œæ­¤é¡¹è¦†ç›– `GET_MEDIA_TOKEN_NOT_STREAM` é€‰é¡¹ä½œç”¨ã€‚
- `GET_MEDIA_TOKEN_NOT_STREAM`ï¼šæ˜¯å¦åœ¨éæµï¼ˆ`stream=false`ï¼‰æƒ…å†µä¸‹ç»Ÿè®¡å›¾ç‰‡tokenï¼Œé»˜è®¤ä¸º `true`ã€‚
- `UPDATE_TASK`ï¼šæ˜¯å¦æ›´æ–°å¼‚æ­¥ä»»åŠ¡ï¼ˆMidjourneyã€Sunoï¼‰ï¼Œé»˜è®¤ä¸º `true`ï¼Œå…³é—­åå°†ä¸ä¼šæ›´æ–°ä»»åŠ¡è¿›åº¦ã€‚
- `GEMINI_MODEL_MAP`ï¼šGeminiæ¨¡å‹æŒ‡å®šç‰ˆæœ¬(v1/v1beta)ï¼Œä½¿ç”¨"æ¨¡å‹:ç‰ˆæœ¬"æŒ‡å®šï¼Œ","åˆ†éš”ï¼Œä¾‹å¦‚ï¼š-e GEMINI_MODEL_MAP="gemini-1.5-pro-latest:v1beta,gemini-1.5-pro-001:v1beta"ï¼Œä¸ºç©ºåˆ™ä½¿ç”¨é»˜è®¤é…ç½®(v1beta)
- `COHERE_SAFETY_SETTING`ï¼šCohereæ¨¡å‹[å®‰å…¨è®¾ç½®](https://docs.cohere.com/docs/safety-modes#overview)ï¼Œå¯é€‰å€¼ä¸º `NONE`, `CONTEXTUAL`, `STRICT`ï¼Œé»˜è®¤ä¸º `NONE`ã€‚
- `GEMINI_VISION_MAX_IMAGE_NUM`ï¼šGeminiæ¨¡å‹æœ€å¤§å›¾ç‰‡æ•°é‡ï¼Œé»˜è®¤ä¸º `16`ï¼Œè®¾ç½®ä¸º `-1` åˆ™ä¸é™åˆ¶ã€‚
- `MAX_FILE_DOWNLOAD_MB`: æœ€å¤§æ–‡ä»¶ä¸‹è½½å¤§å°ï¼Œå•ä½ MBï¼Œé»˜è®¤ä¸º `20`ã€‚
- `CRYPTO_SECRET`ï¼šåŠ å¯†å¯†é’¥ï¼Œç”¨äºåŠ å¯†æ•°æ®åº“å†…å®¹ã€‚
- `AZURE_DEFAULT_API_VERSION`ï¼šAzureæ¸ é“é»˜è®¤APIç‰ˆæœ¬ï¼Œå¦‚æœæ¸ é“è®¾ç½®ä¸­æœªæŒ‡å®šAPIç‰ˆæœ¬ï¼Œåˆ™ä½¿ç”¨æ­¤ç‰ˆæœ¬ï¼Œé»˜è®¤ä¸º `2024-12-01-preview`
## éƒ¨ç½²
> [!TIP]
> æœ€æ–°ç‰ˆDockeré•œåƒï¼š`calciumion/new-api:latest`  
> é»˜è®¤è´¦å·root å¯†ç 123456  
> æ›´æ–°æŒ‡ä»¤ï¼š
> ```
> docker run --rm -v /var/run/docker.sock:/var/run/docker.sock containrrr/watchtower -cR
> ```

### å¤šæœºéƒ¨ç½²
- å¿…é¡»è®¾ç½®ç¯å¢ƒå˜é‡ `SESSION_SECRET`ï¼Œå¦åˆ™ä¼šå¯¼è‡´å¤šæœºéƒ¨ç½²æ—¶ç™»å½•çŠ¶æ€ä¸ä¸€è‡´ã€‚
- å¦‚æœå…¬ç”¨Redisï¼Œå¿…é¡»è®¾ç½® `CRYPTO_SECRET`ï¼Œå¦åˆ™ä¼šå¯¼è‡´å¤šæœºéƒ¨ç½²æ—¶Rediså†…å®¹æ— æ³•è·å–ã€‚

### éƒ¨ç½²è¦æ±‚
- æœ¬åœ°æ•°æ®åº“ï¼ˆé»˜è®¤ï¼‰ï¼šSQLiteï¼ˆDocker éƒ¨ç½²é»˜è®¤ä½¿ç”¨ SQLiteï¼Œå¿…é¡»æŒ‚è½½ `/data` ç›®å½•åˆ°å®¿ä¸»æœºï¼‰
- è¿œç¨‹æ•°æ®åº“ï¼šMySQL ç‰ˆæœ¬ >= 5.7.8ï¼ŒPgSQL ç‰ˆæœ¬ >= 9.6

### ä½¿ç”¨å®å¡”é¢æ¿DockeråŠŸèƒ½éƒ¨ç½²
å®‰è£…å®å¡”é¢æ¿ (**9.2.0ç‰ˆæœ¬**åŠä»¥ä¸Š)ï¼Œå‰å¾€ [å®å¡”é¢æ¿](https://www.bt.cn/new/download.html) å®˜ç½‘ï¼Œé€‰æ‹©æ­£å¼ç‰ˆçš„è„šæœ¬ä¸‹è½½å®‰è£…  
å®‰è£…åç™»å½•å®å¡”é¢æ¿ï¼Œåœ¨èœå•æ ä¸­ç‚¹å‡» Docker ï¼Œé¦–æ¬¡è¿›å…¥ä¼šæç¤ºå®‰è£… Docker æœåŠ¡ï¼Œç‚¹å‡»ç«‹å³å®‰è£…ï¼ŒæŒ‰æç¤ºå®Œæˆå®‰è£…  
å®‰è£…å®Œæˆååœ¨åº”ç”¨å•†åº—ä¸­æ‰¾åˆ° **New-API** ï¼Œç‚¹å‡»å®‰è£…ï¼Œé…ç½®åŸºæœ¬é€‰é¡¹ å³å¯å®Œæˆå®‰è£…  
[å›¾æ–‡æ•™ç¨‹](BT.md)

### åŸºäº Docker è¿›è¡Œéƒ¨ç½²
### ä½¿ç”¨ Docker Compose éƒ¨ç½²ï¼ˆæ¨èï¼‰
```shell
# ä¸‹è½½é¡¹ç›®
git clone https://github.com/Calcium-Ion/new-api.git
cd new-api
# æŒ‰éœ€ç¼–è¾‘ docker-compose.yml
# å¯åŠ¨
docker-compose up -d
```

### ç›´æ¥ä½¿ç”¨ Docker é•œåƒ
```shell
# ä½¿ç”¨ SQLite çš„éƒ¨ç½²å‘½ä»¤ï¼š
docker run --name new-api -d --restart always -p 3000:3000 -e TZ=Asia/Shanghai -v /home/ubuntu/data/new-api:/data calciumion/new-api:latest
# ä½¿ç”¨ MySQL çš„éƒ¨ç½²å‘½ä»¤ï¼Œåœ¨ä¸Šé¢çš„åŸºç¡€ä¸Šæ·»åŠ  `-e SQL_DSN="root:123456@tcp(localhost:3306)/oneapi"`ï¼Œè¯·è‡ªè¡Œä¿®æ”¹æ•°æ®åº“è¿æ¥å‚æ•°ã€‚
# ä¾‹å¦‚ï¼š
docker run --name new-api -d --restart always -p 3000:3000 -e SQL_DSN="root:123456@tcp(localhost:3306)/oneapi" -e TZ=Asia/Shanghai -v /home/ubuntu/data/new-api:/data calciumion/new-api:latest
```

## æ¸ é“é‡è¯•
æ¸ é“é‡è¯•åŠŸèƒ½å·²ç»å®ç°ï¼Œå¯ä»¥åœ¨`è®¾ç½®->è¿è¥è®¾ç½®->é€šç”¨è®¾ç½®`è®¾ç½®é‡è¯•æ¬¡æ•°ï¼Œ**å»ºè®®å¼€å¯ç¼“å­˜**åŠŸèƒ½ã€‚  
å¦‚æœå¼€å¯äº†é‡è¯•åŠŸèƒ½ï¼Œç¬¬ä¸€æ¬¡é‡è¯•ä½¿ç”¨åŒä¼˜å…ˆçº§ï¼Œç¬¬äºŒæ¬¡é‡è¯•ä½¿ç”¨ä¸‹ä¸€ä¸ªä¼˜å…ˆçº§ï¼Œä»¥æ­¤ç±»æ¨ã€‚
### ç¼“å­˜è®¾ç½®æ–¹æ³•
1. `REDIS_CONN_STRING`ï¼šè®¾ç½®ä¹‹åå°†ä½¿ç”¨ Redis ä½œä¸ºç¼“å­˜ä½¿ç”¨ã€‚
    + ä¾‹å­ï¼š`REDIS_CONN_STRING=redis://default:redispw@localhost:49153`
2. `MEMORY_CACHE_ENABLED`ï¼šå¯ç”¨å†…å­˜ç¼“å­˜ï¼ˆå¦‚æœè®¾ç½®äº†`REDIS_CONN_STRING`ï¼Œåˆ™æ— éœ€æ‰‹åŠ¨è®¾ç½®ï¼‰ï¼Œä¼šå¯¼è‡´ç”¨æˆ·é¢åº¦çš„æ›´æ–°å­˜åœ¨ä¸€å®šçš„å»¶è¿Ÿï¼Œå¯é€‰å€¼ä¸º `true` å’Œ `false`ï¼Œæœªè®¾ç½®åˆ™é»˜è®¤ä¸º `false`ã€‚
    + ä¾‹å­ï¼š`MEMORY_CACHE_ENABLED=true`
### ä¸ºä»€ä¹ˆæœ‰çš„æ—¶å€™æ²¡æœ‰é‡è¯•
è¿™äº›é”™è¯¯ç ä¸ä¼šé‡è¯•ï¼š400ï¼Œ504ï¼Œ524
### æˆ‘æƒ³è®©400ä¹Ÿé‡è¯•
åœ¨`æ¸ é“->ç¼–è¾‘`ä¸­ï¼Œå°†`çŠ¶æ€ç å¤å†™`æ”¹ä¸º
```json
{
  "400": "500"
}
```
å¯ä»¥å®ç°400é”™è¯¯è½¬ä¸º500é”™è¯¯ï¼Œä»è€Œé‡è¯•

## Midjourneyæ¥å£è®¾ç½®æ–‡æ¡£
[å¯¹æ¥æ–‡æ¡£](Midjourney.md)

## Sunoæ¥å£è®¾ç½®æ–‡æ¡£
[å¯¹æ¥æ–‡æ¡£](Suno.md)

## ç•Œé¢æˆªå›¾
![image](https://github.com/user-attachments/assets/a0dcd349-5df8-4dc8-9acf-ca272b239919)


![image](https://github.com/user-attachments/assets/c7d0f7e1-729c-43e2-ac7c-2cb73b0afc8e)

![image](https://github.com/user-attachments/assets/29f81de5-33fc-4fc5-a5ff-f9b54b653c7c)

![image](https://github.com/user-attachments/assets/4fa53e18-d2c5-477a-9b26-b86e44c71e35)

## äº¤æµç¾¤
<img src="https://github.com/user-attachments/assets/9ca0bc82-e057-4230-a28d-9f198fa022e3" width="200">

## ç›¸å…³é¡¹ç›®
- [One API](https://github.com/songquanpeng/one-api)ï¼šåŸç‰ˆé¡¹ç›®
- [Midjourney-Proxy](https://github.com/novicezk/midjourney-proxy)ï¼šMidjourneyæ¥å£æ”¯æŒ
- [chatnio](https://github.com/Deeptrain-Community/chatnio)ï¼šä¸‹ä¸€ä»£ AI ä¸€ç«™å¼ B/C ç«¯è§£å†³æ–¹æ¡ˆ
- [neko-api-key-tool](https://github.com/Calcium-Ion/neko-api-key-tool)ï¼šç”¨keyæŸ¥è¯¢ä½¿ç”¨é¢åº¦

å…¶ä»–åŸºäºNew APIçš„é¡¹ç›®ï¼š
- [new-api-horizon](https://github.com/Calcium-Ion/new-api-horizon)ï¼šNew APIé«˜æ€§èƒ½ä¼˜åŒ–ç‰ˆï¼Œå¹¶æ”¯æŒClaudeæ ¼å¼
- [VoAPI](https://github.com/VoAPI/VoAPI)ï¼šåŸºäºNew APIçš„é—­æºé¡¹ç›®

## ğŸŒŸ Star History

[![Star History Chart](https://api.star-history.com/svg?repos=Calcium-Ion/new-api&type=Date)](https://star-history.com/#Calcium-Ion/new-api&Date)
